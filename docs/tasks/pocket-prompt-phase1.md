# Pocket-Prompt Phase 1: 基盤・MVP構築

## フェーズ概要

- **期間**: 1.5ヶ月 (30営業日)
- **目標**: Chrome拡張基盤とMVP必須機能の実装
- **成果物**: 動作するChrome拡張（Private MVP版）
- **担当**: フルスタック開発者

🟢 **青信号**: Phase 1スコープは要件定義書の必須機能（REQ-001〜005）から直接抽出

## 週次計画

### Week 1-2: 基盤構築（Day 1-10）
- **目標**: Chrome拡張開発環境とTypeScript基盤
- **成果物**: 開発環境、manifest.json、基本構造

### Week 3-4: Core機能実装（Day 11-20）
- **目標**: プロンプト管理とストレージ機能
- **成果物**: CRUD機能、Chrome.storage統合

### Week 5-6: UI・統合（Day 21-30）
- **目標**: ポップアップUI、エクスポート機能、統合テスト
- **成果物**: 完動するMVP版拡張

## 日次タスク詳細

### Week 1: 開発環境・基盤構築

#### Day 1 (TASK-0001): プロジェクト初期化・TypeScript環境

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: DIRECT
- **要件リンク**: REQ-401（TypeScript実装必須）
- **依存タスク**: なし
- **実装詳細**:
  - Node.js LTS環境確認・設定
  - TypeScript 5.0+ プロジェクト初期化
  - package.json設定（devDependencies含む）
  - tsconfig.json設定（strict mode、Chrome拡張用）
  - ESLint + Prettier + TypeScript ESLint設定
  - Git初期化、.gitignore設定
- **完了条件**:
  - [ ] `npm run build` でTypeScriptコンパイル成功
  - [ ] `npm run lint` でエラーなし
  - [ ] `npm run format` で自動整形動作
  - [ ] Git初期コミット完了
- **注意事項**: Chrome拡張用TypeScript設定（DOM lib、ES2020 target）

🟢 **青信号**: TypeScript要件は明確に必須要件として定義済み

#### Day 2 (TASK-0002): Chrome拡張Manifest V3基盤

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: DIRECT  
- **要件リンク**: REQ-004（Manifest V3準拠）
- **依存タスク**: TASK-0001
- **実装詳細**:
  - manifest.json作成（Manifest V3準拠）
  - 基本権限設定（storage, activeTab, clipboardWrite）
  - service-worker.js基本構造
  - content-script基本構造
  - popup.html基本構造
  - ディレクトリ構造確立
- **完了条件**:
  - [ ] Chrome Developer Modeで拡張読み込み成功
  - [ ] Background Service Worker動作確認
  - [ ] ポップアップ表示確認
  - [ ] Content Script injection確認
- **注意事項**: Manifest V2との違いに注意（background scripts → service worker）

#### Day 3 (TASK-0003): ビルド環境・バンドラー設定

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: DIRECT
- **要件リンク**: 開発効率要件
- **依存タスク**: TASK-0002
- **実装詳細**:
  - Webpack 5設定（Chrome拡張最適化）
  - TypeScriptローダー設定
  - CSS/SCSS処理設定
  - ファイル圧縮・最適化設定
  - Hot Reloadセットアップ（development用）
  - Production/Development環境分離
- **完了条件**:
  - [ ] `npm run build` でdistファイル生成
  - [ ] `npm run dev` で開発モード動作
  - [ ] TypeScriptソースマップ生成
  - [ ] CSS/JSバンドル最適化確認
- **注意事項**: Chrome拡張特有のContent Security Policy対応

🟡 **黄信号**: ビルド環境詳細は現代的開発慣行から推測

#### Day 4 (TASK-0004): 基本的なプロジェクト構造・アーキテクチャ

- [ ] **タスク完了**
- **推定工数**: 8時間  
- **タスクタイプ**: DIRECT
- **要件リンク**: 設計文書アーキテクチャ
- **依存タスク**: TASK-0003
- **実装詳細**:
  - `/src` ディレクトリ構造確立
  - `/popup`, `/options`, `/background`, `/content` 分離
  - `/core` ビジネスロジック分離
  - `/types` TypeScript型定義配置
  - `/utils` ユーティリティ関数配置
  - `/assets` リソース配置
- **完了条件**:
  - [ ] Clean Architecture準拠の構造
  - [ ] 各モジュール間の依存関係明確
  - [ ] TypeScript絶対パス import設定
  - [ ] README.md プロジェクト説明完備
- **注意事項**: 後から変更困難な構造のため慎重に設計

#### Day 5 (TASK-0005): TypeScriptインターフェース実装

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: 設計文書interfaces.ts
- **依存タスク**: TASK-0004
- **実装詳細**:
  - Core entities（Prompt, Tag, Category）型定義
  - Chrome Message passing型定義
  - Storage interfaces実装
  - API Response/Request型定義
  - Validation interfaces実装
  - Constants定義
- **テスト要件**:
  - [ ] Type guards動作テスト
  - [ ] Interface validation テスト
  - [ ] Constants値テスト
- **完了条件**:
  - [ ] 全インターフェース型チェック通過
  - [ ] Type guardsによる実行時型検証動作
  - [ ] エディタでの型補完動作確認
- **注意事項**: 設計文書のinterfaces.tsを正確に実装

🟢 **青信号**: TypeScript型定義は設計文書で完全に定義済み

### Week 2: Chrome拡張コア機能

#### Day 6 (TASK-0006): Chrome Storage API基盤実装

- [x] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-005（Chrome.storage API必須）
- **依存タスク**: TASK-0005
- **実装詳細**:
  - StorageManager クラス実装
  - chrome.storage.local ラッパー実装
  - データ暗号化/復号化機能（NFR-102）
  - エラーハンドリング・リトライ機能
  - 容量監視・制限チェック
  - データバリデーション
- **テスト要件**:
  - [ ] 基本CRUD操作テスト
  - [ ] エラーハンドリングテスト
  - [ ] 容量制限テスト
  - [ ] 暗号化動作テスト
- **完了条件**:
  - [ ] chrome.storage.local正常読み書き
  - [ ] 5MB制限での適切なエラー処理
  - [ ] 暗号化された状態でのデータ保存確認
- **注意事項**: Chrome拡張セキュリティ要件準拠

#### Day 7 (TASK-0007): メッセージパッシング基盤

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: 設計文書API設計
- **依存タスク**: TASK-0006
- **実装詳細**:
  - Background ↔ Popup メッセージ通信
  - Background ↔ Content Script通信
  - メッセージ型検証・ルーティング
  - 非同期レスポンス管理
  - エラー処理・タイムアウト処理
  - Request/Response IDトラッキング
- **テスト要件**:
  - [ ] 各方向メッセージ通信テスト
  - [ ] タイムアウト処理テスト  
  - [ ] エラーレスポンステスト
  - [ ] 同時リクエスト処理テスト
- **完了条件**:
  - [ ] Popup → Background 通信成功
  - [ ] Background → Content Script通信成功
  - [ ] メッセージタイプルーティング動作
- **注意事項**: Chrome拡張メッセージパッシングAPI制限

#### Day 8 (TASK-0008): プロンプト管理コアロジック実装

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-001（プロンプト保存）
- **依存タスク**: TASK-0007
- **実装詳細**:
  - PromptManager クラス実装
  - プロンプトCRUD操作（Create, Read, Update, Delete）
  - プロンプトバリデーション（タイトル・本文必須、文字数制限）
  - 使用回数・最終使用日時更新
  - 複数行コンテンツ対応
  - UUIDによるID管理
- **テスト要件**:
  - [ ] プロンプト作成テスト
  - [ ] プロンプト取得・更新・削除テスト
  - [ ] バリデーションテスト（必須項目、文字数制限）
  - [ ] 使用統計更新テスト
- **完了条件**:
  - [ ] 全CRUD操作正常動作
  - [ ] 10,000文字制限動作確認（EDGE-101）
  - [ ] 複数行プロンプト正常処理
  - [ ] 使用統計自動更新確認

🟢 **青信号**: プロンプト管理要件は明確に定義済み

#### Day 9 (TASK-0009): クリップボードAPI統合

- [ ] **タスク完了**
- **推定工数**: 6時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-002（ワンクリックコピー）
- **依存タスク**: TASK-0008
- **実装詳細**:
  - ClipboardManager実装
  - chrome.clipboardWrite権限活用
  - 非同期コピー処理
  - コピー成功/失敗フィードバック
  - 複数行テキスト対応
  - 使用統計連携
- **テスト要件**:
  - [ ] 基本コピー機能テスト
  - [ ] 複数行コンテンツコピーテスト
  - [ ] エラーハンドリングテスト
  - [ ] パフォーマンステスト（1秒以内）
- **完了条件**:
  - [ ] ワンクリックでクリップボードにコピー成功
  - [ ] コピー操作1秒以内完了（NFR-002）
  - [ ] エラー時の適切なフィードバック
- **注意事項**: Chrome権限モデル準拠、セキュリティ考慮

#### Day 10 (TASK-0010): エラーハンドリング・ログ基盤

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: 運用品質要件
- **依存タスク**: TASK-0009
- **実装詳細**:
  - ErrorManager実装
  - 構造化エラーログ
  - Chrome拡張特有エラー対応
  - ユーザーフレンドリーエラーメッセージ
  - エラー統計・集計
  - デバッグ情報収集
- **テスト要件**:
  - [ ] エラーキャッチ・ログ記録テスト
  - [ ] エラーメッセージ表示テスト
  - [ ] エラー統計機能テスト
- **完了条件**:
  - [ ] 全モジュールエラーハンドリング統合
  - [ ] ユーザー向けエラーメッセージ表示
  - [ ] デバッグ用ログ収集動作

### Week 3: UI実装・ユーザーインターフェース

#### Day 11 (TASK-0011): ポップアップUI基盤・レイアウト

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-402（ポップアップUI必須）
- **依存タスク**: TASK-0010
- **実装詳細**:
  - popup.html基本レイアウト
  - CSS Grid/Flexboxレイアウト
  - レスポンシブデザイン（画面サイズ対応）
  - Chrome拡張ポップアップサイズ最適化
  - 基本カラーテーマ・フォント設定
  - アクセシビリティ基盤（ARIA属性）
- **UI/UX要件**:
  - [ ] ローディング状態表示
  - [ ] エラー状態表示
  - [ ] 空状態（プロンプトなし）表示
  - [ ] キーボード操作対応
- **テスト要件**:
  - [ ] レスポンシブレイアウトテスト
  - [ ] アクセシビリティテスト
  - [ ] 表示状態切り替えテスト
- **完了条件**:
  - [ ] ポップアップが3秒以内に表示（NFR-001）
  - [ ] 各画面サイズで適切レイアウト
  - [ ] WCAG 2.1 AA基本準拠

🟢 **青信号**: ポップアップUI要件は明確に必須要件として定義済み

#### Day 12 (TASK-0012): プロンプト一覧表示機能

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-101（一覧表示）
- **依存タスク**: TASK-0011
- **実装詳細**:
  - プロンプトリストコンポーネント
  - 仮想スクロール対応（1000+アイテム対応）
  - プロンプトアイテムコンポーネント
  - 使用回数・最終使用日時表示
  - ソート機能（作成日時、使用回数、アルファベット順）
  - ページネーション・無限スクロール
- **UI/UX要件**:
  - [ ] ローディングスピナー
  - [ ] 空状態メッセージ
  - [ ] エラー状態ハンドリング
  - [ ] スムーズスクロールアニメーション
- **テスト要件**:
  - [ ] 大量データ表示パフォーマンステスト
  - [ ] ソート機能テスト
  - [ ] 仮想スクロール動作テスト
- **完了条件**:
  - [ ] 1000件のプロンプト表示で3秒以内
  - [ ] スクロール性能問題なし
  - [ ] 各ソート条件正常動作

#### Day 13 (TASK-0013): プロンプト作成・編集機能

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-001（プロンプト保存）
- **依存タスク**: TASK-0012
- **実装詳細**:
  - プロンプト作成フォーム
  - タイトル・本文入力フィールド
  - 複数行テキストエリア（テキストエリア自動高さ調整）
  - リアルタイムバリデーション
  - 文字数カウンター（10,000文字制限表示）
  - 保存・キャンセルボタン
  - 編集モード対応
- **UI/UX要件**:
  - [ ] 入力中リアルタイム保存（下書き）
  - [ ] バリデーションエラー表示
  - [ ] 保存成功フィードバック
  - [ ] ショートカットキー対応（Ctrl+S保存）
- **テスト要件**:
  - [ ] 必須項目バリデーションテスト
  - [ ] 文字数制限テスト
  - [ ] 保存・編集機能テスト
- **完了条件**:
  - [ ] タイトル・本文必須バリデーション動作
  - [ ] 10,000文字制限で適切エラー表示
  - [ ] 複数行プロンプト正常保存・表示

#### Day 14 (TASK-0014): ワンクリックコピー機能UI実装

- [ ] **タスク完了**
- **推定工数**: 6時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-002（ワンクリックコピー）
- **依存タスク**: TASK-0013
- **実装詳細**:
  - コピーボタンコンポーネント
  - アイコン + ツールチップUI
  - クリック時アニメーション・フィードバック
  - コピー成功/失敗表示
  - キーボードショートカット対応
  - 使用統計リアルタイム更新
- **UI/UX要件**:
  - [ ] クリック時の視覚的フィードバック
  - [ ] コピー成功トースト通知
  - [ ] エラー時の明確なメッセージ表示
  - [ ] ホバー時のプレビュー表示
- **テスト要件**:
  - [ ] コピー機能統合テスト
  - [ ] UI フィードバックテスト
  - [ ] パフォーマンステスト（1秒以内）
- **完了条件**:
  - [ ] ワンクリックで確実にコピー動作
  - [ ] 1秒以内のレスポンス確認（NFR-002）
  - [ ] ユーザーフィードバック明確

#### Day 15 (TASK-0015): 基本設定UI・オプションページ基盤

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-403（オプションページ必須）
- **依存タスク**: TASK-0014
- **実装詳細**:
  - options.html基本レイアウト
  - 設定項目フォーム（theme, language, etc.）
  - 設定値の保存・読み込み
  - 設定変更のリアルタイム反映
  - Export/Import設定
  - リセット機能
- **UI/UX要件**:
  - [ ] 設定変更の即時プレビュー
  - [ ] 保存状態の明確な表示
  - [ ] 設定グループの論理的配置
  - [ ] ヘルプテキスト・説明文
- **テスト要件**:
  - [ ] 設定保存・読み込みテスト
  - [ ] 設定変更反映テスト
  - [ ] リセット機能テスト
- **完了条件**:
  - [ ] 全設定項目正常保存・復元
  - [ ] テーマ変更即座反映
  - [ ] Export/Import機能動作

### Week 4: AIサイト連携・エクスポート機能

#### Day 16 (TASK-0016): Content Script基盤・AIサイト検知

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-003（ChatGPTエクスポート）
- **依存タスク**: TASK-0015
- **実装詳細**:
  - Content Script 動的injection
  - ChatGPTサイト検知ロジック
  - DOM要素セレクタ管理
  - ページナビゲーション対応
  - サイトアップデート耐性設計
  - Background との通信確立
- **テスト要件**:
  - [ ] ChatGPTページ検知テスト
  - [ ] Content Script injection テスト
  - [ ] DOM構造変更耐性テスト
  - [ ] 通信確立テスト
- **完了条件**:
  - [ ] ChatGPTページで自動的にContent Script動作
  - [ ] ページリロード・ナビゲーション対応
  - [ ] Background Script と正常通信

🟢 **青信号**: ChatGPTエクスポート要件は明確に必須機能として定義済み

#### Day 17 (TASK-0017): ChatGPT会話データ抽出・パース

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-003（ChatGPTエクスポート）
- **依存タスク**: TASK-0016
- **実装詳細**:
  - ChatGPT DOM構造解析
  - 会話メッセージ抽出
  - ユーザー/アシスタント区別
  - タイムスタンプ・メタデータ抽出
  - コードブロック・マークアップ保持
  - 会話タイトル取得
- **テスト要件**:
  - [ ] 基本会話抽出テスト
  - [ ] コードブロック保持テスト
  - [ ] 長大会話処理テスト
  - [ ] メタデータ抽出テスト
- **完了条件**:
  - [ ] 会話内容正確抽出確認
  - [ ] コードブロック等のフォーマット保持
  - [ ] 大規模会話（50往復以上）処理確認
- **注意事項**: ChatGPT UI変更に対する堅牢性確保

#### Day 18 (TASK-0018): Markdownエクスポート機能実装

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: REQ-003（Markdownエクスポート）
- **依存タスク**: TASK-0017
- **実装詳細**:
  - Markdown形式変換エンジン
  - 会話構造の適切なMarkdown化
  - メタデータヘッダー生成
  - ファイル名自動生成（日時 + タイトル）
  - ダウンロード機能実装
  - クリップボードコピー選択肢
- **テスト要件**:
  - [ ] Markdown変換正確性テスト
  - [ ] ファイル生成・ダウンロードテスト
  - [ ] 大容量データ処理テスト（30秒以内 - NFR-003）
  - [ ] 特殊文字・エスケープ処理テスト
- **完了条件**:
  - [ ] 完全な会話がMarkdownで出力
  - [ ] メタデータ情報適切に含有
  - [ ] 10MB未満データ30秒以内処理（NFR-003）
  - [ ] 生成ファイル正常ダウンロード

#### Day 19 (TASK-0019): エクスポート履歴・管理機能

- [ ] **タスク完了**
- **推定工数**: 6時間
- **タスクタイプ**: TDD
- **要件リンク**: データ管理要件
- **依存タスク**: TASK-0018
- **実装詳細**:
  - エクスポート履歴ストレージ
  - 履歴一覧表示UI
  - 重複エクスポート検知
  - エクスポート統計情報
  - 古い履歴の自動削除
  - 履歴からの再ダウンロード
- **テスト要件**:
  - [ ] 履歴保存・取得テスト
  - [ ] 重複検知テスト
  - [ ] 自動削除ロジックテスト
- **完了条件**:
  - [ ] エクスポート履歴正常保存
  - [ ] 履歴一覧適切表示
  - [ ] 重複エクスポート警告表示

#### Day 20 (TASK-0020): 統合テスト・デバッグ・調整

- [ ] **タスク完了**
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件リンク**: 品質保証要件
- **依存タスク**: TASK-0019
- **実装詳細**:
  - E2E テストシナリオ実装
  - Chrome拡張全体統合テスト
  - パフォーマンス測定・最適化
  - UI/UXテスト・改善
  - バグ修正・安定性向上
  - Chrome Web Store審査準備
- **テスト要件**:
  - [ ] 主要ユーザージャーニー E2E テスト
  - [ ] パフォーマンス基準達成確認
  - [ ] セキュリティテスト
  - [ ] アクセシビリティテスト
- **完了条件**:
  - [ ] 全機能エラーなく動作
  - [ ] パフォーマンス基準クリア（NFR-001〜003）
  - [ ] Chrome Extension Security審査準備完了
- **注意事項**: リリース品質への最終調整

### Week 5-6: 最終統合・MVP完成

#### Day 21-25 (TASK-0021〜0025): MVP機能統合・最適化

- [ ] **TASK-0021**: UI統合・ユーザビリティ改善（8時間）
- [ ] **TASK-0022**: パフォーマンス最適化・メモリ管理（8時間）
- [ ] **TASK-0023**: セキュリティ強化・脆弱性修正（8時間）
- [ ] **TASK-0024**: エラーハンドリング強化・安定性向上（8時間）
- [ ] **TASK-0025**: ドキュメント・使用説明書作成（8時間）

#### Day 26-30 (TASK-0026〜0030): 最終テスト・リリース準備

- [ ] **TASK-0026**: 受け入れテスト・ユーザビリティテスト（8時間）
- [ ] **TASK-0027**: Chrome Web Store申請素材準備（8時間）
- [ ] **TASK-0028**: プライベート版デプロイ・配布準備（8時間）
- [ ] **TASK-0029**: バックアップ・復旧手順作成（8時間）
- [ ] **TASK-0030**: Phase 2移行準備・引き継ぎ資料（8時間）

## Phase 1完了基準

### 必須完了項目
- [ ] 全タスク完了確認 (30/30)
- [ ] Chrome拡張として正常動作確認
- [ ] 必須機能（REQ-001〜005, REQ-401〜403）100%実装
- [ ] パフォーマンス基準達成（NFR-001〜003）
- [ ] セキュリティ要件準拠（NFR-101〜103）

### 品質基準
- [ ] テストカバレッジ80%以上
- [ ] Chrome Extension Security Review合格レベル
- [ ] ユーザビリティテスト合格（5分以内習得）
- [ ] エラーハンドリング完備
- [ ] アクセシビリティ基本対応

### 成果物確認
- [ ] Chrome拡張パッケージファイル（.crx）
- [ ] インストール・使用マニュアル
- [ ] 開発者向けドキュメント
- [ ] テスト結果レポート
- [ ] パフォーマンスベンチマーク

## Phase 2への引き継ぎ事項

### 技術的引き継ぎ
- TypeScript基盤設定・ビルド環境
- Chrome拡張アーキテクチャ・設計判断
- パフォーマンス測定結果・改善点
- セキュリティ脆弱性チェック結果

### 機能的引き継ぎ
- 実装完了機能一覧・動作確認
- 既知バグ・制限事項リスト
- ユーザーフィードバック・改善要望
- Phase 2で強化すべき品質項目

### データ・設定
- 開発環境設定詳細
- テストデータ・シナリオ
- 設定ファイル・環境変数
- デプロイ手順・運用手順

## 振り返り・改善事項

### 計画との差異（Phase 1完了後記入）
- [ ] スケジュール差異: ±___日
- [ ] 工数差異: ±___時間  
- [ ] 技術的課題: ___________
- [ ] 品質課題: ___________

### Phase 2での重点改善項目
- [ ] TypeScript化完全対応
- [ ] テストカバレッジ90%達成
- [ ] パフォーマンス更なる最適化
- [ ] UI/UXユーザビリティ向上
- [ ] セキュリティ強化

🟢 **青信号**: Phase 1完了基準は要件定義書の必須機能要件から直接設定