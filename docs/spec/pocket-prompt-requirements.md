# Pocket-Prompt Chrome拡張 要件定義書

## 概要

Pocket-PromptはChrome拡張機能として開発される、プロンプト管理とAIチャット履歴エクスポート機能を提供するツールです。個人利用からスタートし、将来的にはOSSとして公開することを想定した設計となっています。

🟡 **黄信号**: プロジェクト名とライセンス戦略（Private → MIT公開）は提供された要件から妥当な推測

## 関連文書

- **ユーザストーリー**: [📖 pocket-prompt-user-stories.md](pocket-prompt-user-stories.md)
- **受け入れ基準**: [✅ pocket-prompt-acceptance-criteria.md](pocket-prompt-acceptance-criteria.md)

## 機能要件（EARS記法）

### 通常要件（SHALL）

- **REQ-001**: システムはプロンプトをタイトルと本文（複数行対応）で保存しなければならない
- **REQ-002**: システムは保存済みプロンプトをワンクリックでクリップボードにコピーしなければならない  
- **REQ-003**: システムはChatGPTの会話履歴をMarkdown形式でエクスポートしなければならない
- **REQ-004**: システムはManifest V3に準拠したChrome拡張として動作しなければならない
- **REQ-005**: システムはChrome.storage APIを使用してローカルストレージでデータを管理しなければならない

🟢 **青信号**: 必須機能要件は提供された要件から直接抽出

### 条件付き要件（WHEN/IF-THEN）

- **REQ-101**: ユーザーがポップアップUIを開いた場合、システムは保存済みプロンプト一覧を表示しなければならない
- **REQ-102**: ユーザーがプロンプトを選択した場合、システムはワンクリックでコピー可能な状態にしなければならない
- **REQ-103**: ユーザーがChatGPTページにアクセスしている場合、システムは会話履歴エクスポート機能を利用可能にしなければならない
- **REQ-104**: OSSフェーズに移行する場合、システムはMITライセンスでv0.1.0として公開しなければならない

🟢 **青信号**: フェーズ戦略とUI要件は提供された要件から直接抽出

### 状態要件（WHERE）

- **REQ-201**: プライベート利用フェーズにある場合、システムはローカルストレージのみでデータを管理しなければならない
- **REQ-202**: MVP完成状態にある場合、システはコード整備フェーズへの移行を可能にしなければならない

🟡 **黄信号**: フェーズ管理の詳細な状態遷移は一般的な開発フローから推測

### オプション要件（MAY）

- **REQ-301**: システムはタグ・カテゴリによるプロンプト管理機能を提供してもよい
- **REQ-302**: システムはキーワード検索・タグ検索機能を提供してもよい
- **REQ-303**: システムはChatGPT/Claude/Geminiの入力欄への直接ペースト機能を提供してもよい
- **REQ-304**: システムはClaude・Geminiの会話履歴エクスポート機能を提供してもよい
- **REQ-305**: システはGoogleアカウントと連携したクラウド同期機能を提供してもよい

🟢 **青信号**: Option機能は提供された要件リストから直接抽出

### 制約要件（MUST）

- **REQ-401**: システムはTypeScriptで実装しなければならない
- **REQ-402**: システムはChrome拡張のポップアップUIとして実装しなければならない
- **REQ-403**: システムは詳細管理用のオプションページを提供しなければならない

🟢 **青信号**: 技術・UI要件は提供された仕様から直接抽出

## 非機能要件

### パフォーマンス

- **NFR-001**: ポップアップUIは3秒以内に起動しなければならない
- **NFR-002**: プロンプトコピー操作は1秒以内に完了しなければならない
- **NFR-003**: 会話履歴エクスポートは10MB未満のデータに対して30秒以内に完了しなければならない

🔴 **赤信号**: パフォーマンス要件は一般的なUX基準から推測

### セキュリティ

- **NFR-101**: システムは最小権限の原則に従いChrome権限を要求しなければならない
- **NFR-102**: システムはユーザーデータを暗号化してローカル保存しなければならない
- **NFR-103**: クラウド同期機能実装時は、OAuth 2.0を使用してGoogleアカウント認証を行わなければならない

🟡 **黄信号**: セキュリティ要件は提供されたクラウド同期要件とWeb拡張のベストプラクティスから推測

### ユーザビリティ

- **NFR-201**: UIは直感的で初回利用時に説明なしで操作できなければならない
- **NFR-202**: プロンプト管理は5クリック以内で完結しなければならない
- **NFR-203**: エラーメッセージは具体的で解決方法を示さなければならない

🔴 **赤信号**: ユーザビリティ要件は一般的なUX原則から推測

### 拡張性

- **NFR-301**: コードベースはOSS公開時にコントリビューターが理解しやすい構造でなければならない
- **NFR-302**: AI サイト連携は新しいサービスを容易に追加できる設計でなければならない
- **NFR-303**: エクスポート機能は新しい形式を容易に追加できる設計でなければならない

🟡 **黄信号**: 拡張性要件は提供されたOption機能とOSS公開要件から推測

## Edgeケース

### エラー処理

- **EDGE-001**: Chrome.storage APIエラー時は適切なフォールバック処理を実行する
- **EDGE-002**: 大容量データ（>5MB）の保存試行時は警告を表示する
- **EDGE-003**: 不正な形式のエクスポートデータに対してはエラーメッセージを表示する
- **EDGE-004**: ネットワーク接続なしでクラウド同期を試行した場合はオフラインモードで動作する

🔴 **赤信号**: エラーハンドリングは一般的なWeb拡張開発の課題から推測

### 境界値

- **EDGE-101**: プロンプト本文の最大文字数制限（10,000文字）を設ける
- **EDGE-102**: 保存可能プロンプト数の上限（1,000件）を設ける
- **EDGE-103**: 同時エクスポート可能な会話履歴数の上限（50会話）を設ける

🔴 **赤信号**: 容量制限は一般的なローカルストレージ制約から推測

### 互換性

- **EDGE-201**: Chrome バージョン88以降での動作保証
- **EDGE-202**: ChatGPTサイトのUIアップデートに対する対応
- **EDGE-203**: 将来のAIサービス（Claude、Gemini）のUI変更に対する対応

🟡 **黄信号**: 互換性要件は提供された対応AI一覧と現実的な制約から推測

## 開発フェーズ

### Phase 1: Private MVP
- 必須機能（REQ-001～REQ-005）の実装
- ローカルストレージベースの基本機能

### Phase 2: コード整備
- TypeScript化完了
- テストカバレッジ80%以上
- ドキュメント整備

### Phase 3: OSS公開（v0.1.0）
- MITライセンス適用
- GitHub公開
- コントリビューションガイドライン作成

🟢 **青信号**: 開発フェーズ戦略は提供された要件から直接抽出